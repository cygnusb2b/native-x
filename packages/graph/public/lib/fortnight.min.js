!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=9)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.withTimeout=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3,n=!1,r=function(){n||(n=!0,t.apply(void 0,arguments))};return setTimeout(r,e),r},e.buildQuery=function(t){return Object.keys(t).filter(function(e){return t[e]}).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])}).join("&")},e.domReady=function(t){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function e(){document.removeEventListener("DOMContentLoaded",e),t()}):t()},e.extractFieldsFrom=function(t){if(1!==t.nodeType)return{};var e=t.getAttribute("data-fortnight-fields");if(!e)return{};try{return JSON.parse(decodeURIComponent(e))||{}}catch(t){return{}}},e.isTrackable=function(t,e){return 1===t.nodeType&&e===t.getAttribute("data-fortnight-action")},e.logSupport=function(t,e){window.Raven&&t&&window.Raven.captureMessage(e,{level:"warning"})},e.assign=Object.assign||function(t){for(var e=arguments,n=function(n,r){var o=Object(e.length<=n+1?void 0:e[n+1]);Object.keys(o).forEach(function(e){Object.prototype.hasOwnProperty.call(o,e)&&(t[e]=o[e])})},r=0,o=arguments.length<=1?0:arguments.length-1;r<o;r+=1)n(r);return t}},function(t,e,n){"use strict";n.r(e);const r=window.Element.prototype,o=r.matches||r.matchesSelector||r.webkitMatchesSelector||r.mozMatchesSelector||r.msMatchesSelector||r.oMatchesSelector;function i(t,e){if(t&&1==t.nodeType&&e){if("string"==typeof e||1==e.nodeType)return t==e||s(t,e);if("length"in e)for(let n,r=0;n=e[r];r++)if(t==n||s(t,n))return!0}return!1}function s(t,e){if("string"!=typeof e)return!1;if(o)return o.call(t,e);const n=t.parentNode.querySelectorAll(e);for(let e,r=0;e=n[r];r++)if(e==t)return!0;return!1}function a(t){const e=[];for(;t&&t.parentNode&&1==t.parentNode.nodeType;)t=t.parentNode,e.push(t);return e}function c(t,e,n=!1){if(!t||1!=t.nodeType||!e)return;const r=(n?[t]:[]).concat(a(t));for(let t,n=0;t=r[n];n++)if(i(t,e))return t}function u(t,e,n,r,o={}){const s=function(t){let e;if(o.composed&&"function"==typeof t.composedPath){const r=t.composedPath();for(let t,o=0;t=r[o];o++)1==t.nodeType&&i(t,n)&&(e=t)}else e=c(t.target,n,!0);e&&r.call(e,t,e)};return t.addEventListener(e,s,o.useCapture),{destroy:function(){t.removeEventListener(e,s,o.useCapture)}}}function l(t,e,n="Event",r={}){let o,i;"object"==typeof n&&(r=n,n="Event"),r.bubbles=r.bubbles||!1,r.cancelable=r.cancelable||!1,r.composed=r.composed||!1,"detail"in r&&(i=!0),n=i?"CustomEvent":n;try{o=new window[n](e,r)}catch(t){(o=document.createEvent(n))["init"+(i?"Custom":"")+"Event"](e,r.bubbles,r.cancelable,r.detail)}return t.dispatchEvent(o)}function h(t){const e={};if(!t||1!=t.nodeType)return e;const n=t.attributes;if(0===n.length)return{};for(let t,r=0;t=n[r];r++)e[t.name]=t.value;return e}const d="80",f="443",p=RegExp(":("+d+"|"+f+")$"),v=document.createElement("a"),b={};function m(t){if(t=t&&"."!=t?t:location.href,b[t])return b[t];if(v.href=t,"."==t.charAt(0)||"/"==t.charAt(0))return m(v.href);let e=v.port==d||v.port==f?"":v.port;e="0"==e?"":e;const n=v.host.replace(p,""),r=v.origin?v.origin:v.protocol+"//"+n,o="/"==v.pathname.charAt(0)?v.pathname:"/"+v.pathname;return b[t]={hash:v.hash,host:n,hostname:v.hostname,href:v.href,origin:r,pathname:o,port:e,protocol:v.protocol,search:v.search}}n.d(e,"closest",function(){return c}),n.d(e,"delegate",function(){return u}),n.d(e,"dispatch",function(){return l}),n.d(e,"getAttributes",function(){return h}),n.d(e,"matches",function(){return i}),n.d(e,"parents",function(){return a}),n.d(e,"parseUrl",function(){return m})},function(t,e){!function(t,e){"use strict";if("IntersectionObserver"in t&&"IntersectionObserverEntry"in t&&"intersectionRatio"in t.IntersectionObserverEntry.prototype)"isIntersecting"in t.IntersectionObserverEntry.prototype||Object.defineProperty(t.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});else{var n=[];o.prototype.THROTTLE_TIMEOUT=100,o.prototype.POLL_INTERVAL=null,o.prototype.USE_MUTATION_OBSERVER=!0,o.prototype.observe=function(t){if(!this._observationTargets.some(function(e){return e.element==t})){if(!t||1!=t.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:t,entry:null}),this._monitorIntersections(),this._checkForIntersections()}},o.prototype.unobserve=function(t){this._observationTargets=this._observationTargets.filter(function(e){return e.element!=t}),this._observationTargets.length||(this._unmonitorIntersections(),this._unregisterInstance())},o.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorIntersections(),this._unregisterInstance()},o.prototype.takeRecords=function(){var t=this._queuedEntries.slice();return this._queuedEntries=[],t},o.prototype._initThresholds=function(t){var e=t||[0];return Array.isArray(e)||(e=[e]),e.sort().filter(function(t,e,n){if("number"!=typeof t||isNaN(t)||t<0||t>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return t!==n[e-1]})},o.prototype._parseRootMargin=function(t){var e=(t||"0px").split(/\s+/).map(function(t){var e=/^(-?\d*\.?\d+)(px|%)$/.exec(t);if(!e)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(e[1]),unit:e[2]}});return e[1]=e[1]||e[0],e[2]=e[2]||e[0],e[3]=e[3]||e[1],e},o.prototype._monitorIntersections=function(){this._monitoringIntersections||(this._monitoringIntersections=!0,this.POLL_INTERVAL?this._monitoringInterval=setInterval(this._checkForIntersections,this.POLL_INTERVAL):(i(t,"resize",this._checkForIntersections,!0),i(e,"scroll",this._checkForIntersections,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in t&&(this._domObserver=new MutationObserver(this._checkForIntersections),this._domObserver.observe(e,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))))},o.prototype._unmonitorIntersections=function(){this._monitoringIntersections&&(this._monitoringIntersections=!1,clearInterval(this._monitoringInterval),this._monitoringInterval=null,s(t,"resize",this._checkForIntersections,!0),s(e,"scroll",this._checkForIntersections,!0),this._domObserver&&(this._domObserver.disconnect(),this._domObserver=null))},o.prototype._checkForIntersections=function(){var e=this._rootIsInDom(),n=e?this._getRootRect():{top:0,bottom:0,left:0,right:0,width:0,height:0};this._observationTargets.forEach(function(o){var i=o.element,s=a(i),c=this._rootContainsTarget(i),u=o.entry,l=e&&c&&this._computeTargetAndRootIntersection(i,n),h=o.entry=new r({time:t.performance&&performance.now&&performance.now(),target:i,boundingClientRect:s,rootBounds:n,intersectionRect:l});u?e&&c?this._hasCrossedThreshold(u,h)&&this._queuedEntries.push(h):u&&u.isIntersecting&&this._queuedEntries.push(h):this._queuedEntries.push(h)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)},o.prototype._computeTargetAndRootIntersection=function(n,r){if("none"!=t.getComputedStyle(n).display){for(var o,i,s,c,l,h,d,f,p=a(n),v=u(n),b=!1;!b;){var m=null,g=1==v.nodeType?t.getComputedStyle(v):{};if("none"==g.display)return;if(v==this.root||v==e?(b=!0,m=r):v!=e.body&&v!=e.documentElement&&"visible"!=g.overflow&&(m=a(v)),m&&(o=m,i=p,s=Math.max(o.top,i.top),c=Math.min(o.bottom,i.bottom),l=Math.max(o.left,i.left),f=c-s,!(p=(d=(h=Math.min(o.right,i.right))-l)>=0&&f>=0&&{top:s,bottom:c,left:l,right:h,width:d,height:f})))break;v=u(v)}return p}},o.prototype._getRootRect=function(){var t;if(this.root)t=a(this.root);else{var n=e.documentElement,r=e.body;t={top:0,left:0,right:n.clientWidth||r.clientWidth,width:n.clientWidth||r.clientWidth,bottom:n.clientHeight||r.clientHeight,height:n.clientHeight||r.clientHeight}}return this._expandRectByRootMargin(t)},o.prototype._expandRectByRootMargin=function(t){var e=this._rootMarginValues.map(function(e,n){return"px"==e.unit?e.value:e.value*(n%2?t.width:t.height)/100}),n={top:t.top-e[0],right:t.right+e[1],bottom:t.bottom+e[2],left:t.left-e[3]};return n.width=n.right-n.left,n.height=n.bottom-n.top,n},o.prototype._hasCrossedThreshold=function(t,e){var n=t&&t.isIntersecting?t.intersectionRatio||0:-1,r=e.isIntersecting?e.intersectionRatio||0:-1;if(n!==r)for(var o=0;o<this.thresholds.length;o++){var i=this.thresholds[o];if(i==n||i==r||i<n!=i<r)return!0}},o.prototype._rootIsInDom=function(){return!this.root||c(e,this.root)},o.prototype._rootContainsTarget=function(t){return c(this.root||e,t)},o.prototype._registerInstance=function(){n.indexOf(this)<0&&n.push(this)},o.prototype._unregisterInstance=function(){var t=n.indexOf(this);-1!=t&&n.splice(t,1)},t.IntersectionObserver=o,t.IntersectionObserverEntry=r}function r(t){this.time=t.time,this.target=t.target,this.rootBounds=t.rootBounds,this.boundingClientRect=t.boundingClientRect,this.intersectionRect=t.intersectionRect||{top:0,bottom:0,left:0,right:0,width:0,height:0},this.isIntersecting=!!t.intersectionRect;var e=this.boundingClientRect,n=e.width*e.height,r=this.intersectionRect,o=r.width*r.height;this.intersectionRatio=n?o/n:this.isIntersecting?1:0}function o(t,e){var n,r,o,i=e||{};if("function"!=typeof t)throw new Error("callback must be a function");if(i.root&&1!=i.root.nodeType)throw new Error("root must be an Element");this._checkForIntersections=(n=this._checkForIntersections.bind(this),r=this.THROTTLE_TIMEOUT,o=null,function(){o||(o=setTimeout(function(){n(),o=null},r))}),this._callback=t,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(i.rootMargin),this.thresholds=this._initThresholds(i.threshold),this.root=i.root||null,this.rootMargin=this._rootMarginValues.map(function(t){return t.value+t.unit}).join(" ")}function i(t,e,n,r){"function"==typeof t.addEventListener?t.addEventListener(e,n,r||!1):"function"==typeof t.attachEvent&&t.attachEvent("on"+e,n)}function s(t,e,n,r){"function"==typeof t.removeEventListener?t.removeEventListener(e,n,r||!1):"function"==typeof t.detatchEvent&&t.detatchEvent("on"+e,n)}function a(t){var e;try{e=t.getBoundingClientRect()}catch(t){}return e?(e.width&&e.height||(e={top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.right-e.left,height:e.bottom-e.top}),e):{top:0,bottom:0,left:0,right:0,width:0,height:0}}function c(t,e){for(var n=e;n;){if(n==t)return!0;n=u(n)}return!1}function u(t){var e=t.parentNode;return e&&11==e.nodeType&&e.host?e.host:e}}(window,document)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(0);function i(t,e){if(0===t){var n=e.intersectionRect;return n.top>0||n.bottom>0||n.left>0||n.right>0}return e.intersectionRatio>=t}n(2);var s=function(){function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),(0,o.logSupport)(!window.IntersectionObserver,"IntersectionObserver is not supported."),(0,o.logSupport)(!window.MutationObserver,"MutationObserver is not supported."),window.IntersectionObserver&&window.MutationObserver&&(this.opts=(0,o.assign)({trackOnce:!0,threshold:.25,rootMargin:"0px"},r),this.handleIntersection=this.handleIntersection.bind(this),this.handleMutations=this.handleMutations.bind(this),this.handleAddedElement=this.handleAddedElement.bind(this),this.handleRemovedElement=this.handleRemovedElement.bind(this),this.mutationObserver=null,this.intersectionObserver=null,this.tracker=e,(0,o.domReady)(function(){n.observeElements()}))}return r(t,[{key:"observeElements",value:function(){var e=this;this.intersectionObserver||(this.intersectionObserver=new IntersectionObserver(this.handleIntersection,{rootMargin:this.opts.rootMargin,threshold:this.opts.threshold}),t.getElements().forEach(function(t){return e.intersectionObserver.observe(t)})),this.mutationObserver||(this.mutationObserver=new MutationObserver(this.handleMutations),this.mutationObserver.observe(document.body,{childList:!0,subtree:!0})),requestAnimationFrame(function(){})}},{key:"unobserveAllElements",value:function(){this.intersectionObserver.disconnect(),this.intersectionObserver=null,this.mutationObserver.disconnect(),this.mutationObserver=null,this.elementMap={}}},{key:"handleIntersection",value:function(t){for(var e=0;e<t.length;e+=1){var n=t[e];if(i(this.opts.threshold,n)){var r=n.target;this.sendEvent(r),this.opts.trackOnce&&this.handleRemovedElement(r)}}}},{key:"handleMutations",value:function(t){var e=this;t.forEach(function(t){for(var n=t.addedNodes,r=t.removedNodes,o=0;o<r.length;o+=1){var i=r[o];e.walkTree(i,e.handleRemovedElement)}for(var s=0;s<n.length;s+=1){var a=n[s];e.walkTree(a,e.handleAddedElement)}})}},{key:"handleAddedElement",value:function(t){t&&this.intersectionObserver.observe(t)}},{key:"handleRemovedElement",value:function(t){t&&this.intersectionObserver.unobserve(t)}},{key:"walkTree",value:function(t,e){(0,o.isTrackable)(t,"view")&&e(t);for(var n=0;n<t.childNodes.length;n+=1){var r=t.childNodes[n];this.walkTree(r,e)}}},{key:"sendEvent",value:function(t){var e=(0,o.extractFieldsFrom)(t);this.tracker.execute("event","view",e,{transport:"beacon"})}},{key:"destroy",value:function(){this.unobserveAllElements()}}],[{key:"getElements",value:function(){for(var t=[],e=document.querySelectorAll('[data-fortnight-action="view"]'),n=0;n<e.length;n+=1)t.push(e[n]);return t}}]),t}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(0),i="https://fortnight.as3.io",s=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var n={domain:i};this.options=(0,o.assign)(n,e)}return r(t,[{key:"send",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.pid,r=e.cid,i=e.uuid,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=s.transport,c=s.callback,u=String(t).trim().toLowerCase();if(u){var l={pid:n,cid:r,uuid:i,_:(new Date).getTime()},h=(0,o.buildQuery)(l),d="/e/"+u+".gif?"+h,f=this.createUrl(d);if("beacon"===a&&navigator.sendBeacon)"function"==typeof c&&c(u,l),navigator.sendBeacon(f);else{var p=document.createElement("img");"function"==typeof c&&(p.onload=function(){return c(u,l)},p.onerror=function(){return c(u,l)}),p.src=f}}}},{key:"createUrl",value:function(t){return this.domain+"/"+t.replace(/^\/+/,"")}},{key:"domain",get:function(){return this.options.domain?""+this.options.domain.replace(/\/+$/,""):i}}]),t}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(1),i=n(0),s=function(){function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),(0,i.logSupport)(!r.enabled,"LinkListener is disabled."),(0,i.logSupport)(!window.addEventListener,"addEventListener is not supported."),r.enabled&&window.addEventListener){this.tracker=e;var s={events:["click"],selector:"a",shouldTrackLink:t.shouldTrackLink,callback:void 0};this.opts=(0,i.assign)(s,r),this.handleInteractions=this.handleInteractions.bind(this),this.delegates={},this.opts.events.forEach(function(t){n.delegates[t]=(0,o.delegate)(document,t,n.opts.selector,n.handleInteractions,{composed:!0,useCapture:!0})})}}return r(t,[{key:"handleInteractions",value:function(t,e){var n=this;if(this.opts.shouldTrackLink(e,o.parseUrl)){var r=e.getAttribute("href"),s=(0,i.extractFieldsFrom)(e),a={transport:"beacon",callback:this.opts.callback};!navigator.sendBeacon&&function(t,e){return!("click"!==t.type||"_blank"===e.target||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey||t.which>1)}(t,e)?window.addEventListener("click",function e(){if(window.removeEventListener("click",e),!t.defaultPrevented){t.preventDefault();var o=a.callback;a.callback=(0,i.withTimeout)(function(){"function"==typeof o&&o.apply(void 0,arguments),window.location.href=r})}n.tracker.execute("event","click",s,a)}):this.tracker.execute("event","click",s,a)}}},{key:"destroy",value:function(){var t=this;Object.keys(this.delegates).forEach(function(e){return t.delegates[e].destroy()})}}],[{key:"shouldTrackLink",value:function(t,e){return"http"===e(t.getAttribute("href")).protocol.slice(0,4)&&(0,i.isTrackable)(t,"click")}}]),t}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(0),i=c(n(5)),s=c(n(4)),a=c(n(3));function c(t){return t&&t.__esModule?t:{default:t}}var u=[],l=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var n=(0,o.assign)({trackLinks:!0,debug:!1,onLinkTrack:void 0},e);this.opts=n;var r=new s.default({domain:n.domain});this.commands={event:r.send.bind(r)},u.push(new i.default(this,{enabled:n.trackLinks,callback:n.onLinkTrack})),u.push(new a.default(this,{}))}return r(t,[{key:"execute",value:function(t){if(this.commands[t]){for(var e,n,r=arguments.length,o=Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];this.opts.debug&&(n=console).info.apply(n,["FORTNIGHT","Tracker.execute",t].concat(o)),(e=this.commands)[t].apply(e,o)}}},{key:"destroy",value:function(){u.forEach(function(t){return t.destroy()})}}]),t}();e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];if("init"===t)i||(i=new(Function.prototype.bind.apply(o.default,[null].concat(n))));else if("destroy"===t)i&&(i.destroy(),i=void 0);else{var s;if(!i)throw new Error("No Fortnight instance has been initialized.");(s=i).execute.apply(s,[t].concat(n))}};var r,o=(r=n(6))&&r.__esModule?r:{default:r},i=void 0},function(t,e,n){"use strict";var r,o=(r=n(7))&&r.__esModule?r:{default:r};function i(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var s=window.FortnightObject;if(!s||!window[s])throw new Error("No FortnightObject object was found or initialized. Was the proper JavaScript included on the page?");var a=window[s].q;Array.isArray(a)&&(a.filter(function(t){return"init"===t[0]}).forEach(function(t){return o.default.apply(void 0,i(t))}),a.filter(function(t){return"init"!==t[0]}).forEach(function(t){return o.default.apply(void 0,i(t))})),window[s]=o.default},function(t,e,n){t.exports=n(8)}]);
//# sourceMappingURL=fortnight.min.js.map