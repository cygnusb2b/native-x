{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/dom-utils/lib/matches.js","webpack:///./node_modules/dom-utils/index.js","webpack:///./node_modules/dom-utils/lib/parents.js","webpack:///./node_modules/dom-utils/lib/closest.js","webpack:///./src/utils.js","webpack:///./src/tracker/link-listener.js","webpack:///./src/tracker/event-transport.js","webpack:///./src/tracker/view-listener.js","webpack:///./src/tracker/index.js","webpack:///./src/app.js","webpack:///./src/index.js","webpack:///./node_modules/intersection-observer/intersection-observer.js","webpack:///./node_modules/dom-utils/lib/parse-url.js","webpack:///./node_modules/dom-utils/lib/get-attributes.js","webpack:///./node_modules/dom-utils/lib/dispatch.js","webpack:///./node_modules/dom-utils/lib/delegate.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","r","value","n","__esModule","default","object","property","prototype","hasOwnProperty","p","s","t","e","element","test","nodeType","matchesSelector","item","proto","window","Element","nativeMatches","matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","selector","node","nodes","parentNode","querySelectorAll","parseUrl","parents","getAttributes","dispatch","delegate","closest","a","u","list","push","shouldCheckSelf","arguments","length","parent","parentElements","concat","_parents2","_matches2","extractFieldsFrom","data","getAttribute","JSON","parse","decodeURIComponent","isTrackable","action","logSupport","message","Raven","captureMessage","level","assign","writable","key","LinkListener","tracker","options","TypeError","this","enabled","addEventListener","defaults","events","shouldTrackLink","callback","opts","link_listener_extends","handleInteractions","bind","delegates","event","dom_utils","document","composed","useCapture","link","_this","href","fields","eventOpts","transport","navigator","sendBeacon","type","target","metaKey","ctrlKey","shiftKey","altKey","which","handler","removeEventListener","defaultPrevented","preventDefault","original","wait","wasCalled","fn","setTimeout","location","execute","keys","destroy","urlParser","protocol","slice","h","event_transport_domain","f","EventTransport","domain","event_transport_extends","_ref","pid","cid","uuid","_ref2","act","String","trim","toLowerCase","obj","params","_","Date","getTime","query","filter","k","map","encodeURIComponent","join","endpoint","url","createUrl","img","createElement","onload","onerror","src","replace","view_listener_isVisible","threshold","record","intersectionRect","top","bottom","left","right","intersectionRatio","g","ViewListener","IntersectionObserver","MutationObserver","view_listener_extends","trackOnce","rootMargin","handleIntersection","handleMutations","handleAddedElement","handleRemovedElement","mutationObserver","intersectionObserver","observeElements","readyState","elements","getElements","observe","body","childList","subtree","requestAnimationFrame","disconnect","elementMap","records","sendEvent","mutations","mutation","addedNodes","removedNodes","removed","walkTree","added","unobserve","childNodes","child","unobserveAllElements","y","tracker_listeners","Tracker","tracker_extends","trackLinks","debug","onLinkTrack","event_transport","commands","send","link_listener","view_listener","command","_commands","_console","_len","args","Array","_key","console","info","apply","app_tracker","app_app","src_tracker","_tracker","Error","src_queueName","FortnightObject","src_execute","stack","app","src_toConsumableArray","src_queue","q","isArray","src_first","src_next","src_i","src_args","IntersectionObserverEntry","registry","THROTTLE_TIMEOUT","POLL_INTERVAL","USE_MUTATION_OBSERVER","_observationTargets","some","_registerInstance","entry","_monitorIntersections","_checkForIntersections","_unmonitorIntersections","_unregisterInstance","takeRecords","_queuedEntries","_initThresholds","opt_threshold","sort","isNaN","_parseRootMargin","opt_rootMargin","margins","split","margin","parts","exec","parseFloat","unit","_monitoringIntersections","_monitoringInterval","setInterval","addEvent","_domObserver","attributes","characterData","clearInterval","removeEvent","rootIsInDom","_rootIsInDom","rootRect","_getRootRect","width","height","forEach","targetRect","getBoundingClientRect","rootContainsTarget","_rootContainsTarget","oldEntry","_computeTargetAndRootIntersection","newEntry","time","performance","now","boundingClientRect","rootBounds","_hasCrossedThreshold","isIntersecting","_callback","getComputedStyle","display","rect1","rect2","getParentNode","atRoot","parentRect","parentComputedStyle","root","documentElement","overflow","Math","max","min","html","clientWidth","clientHeight","_expandRectByRootMargin","rect","_rootMarginValues","newRect","oldRatio","newRatio","thresholds","containsDeep","indexOf","index","splice","targetArea","intersectionArea","opt_options","timeout","timer","opt_useCapture","attachEvent","detatchEvent","el","err","host","cache","charAt","port","HTTP_PORT","HTTPS_PORT","DEFAULT_PORT","origin","pathname","hash","hostname","search","RegExp","attrs","attr","eventType","eventName","initDict","isCustom","_typeof","bubbles","cancelable","createEvent","detail","dispatchEvent","ancestor","listener","delegateTarget","composedPath","_closest2"],"mappings":"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","file":"fortnight.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 10);\n","const proto = window.Element.prototype;\nconst nativeMatches = proto.matches ||\n      proto.matchesSelector ||\n      proto.webkitMatchesSelector ||\n      proto.mozMatchesSelector ||\n      proto.msMatchesSelector ||\n      proto.oMatchesSelector;\n\n\n/**\n * Tests if a DOM elements matches any of the test DOM elements or selectors.\n * @param {Element} element The DOM element to test.\n * @param {Element|string|Array<Element|string>} test A DOM element, a CSS\n *     selector, or an array of DOM elements or CSS selectors to match against.\n * @return {boolean} True of any part of the test matches.\n */\nexport default function matches(element, test) {\n  // Validate input.\n  if (element && element.nodeType == 1 && test) {\n    // if test is a string or DOM element test it.\n    if (typeof test == 'string' || test.nodeType == 1) {\n      return element == test ||\n          matchesSelector(element, /** @type {string} */ (test));\n    } else if ('length' in test) {\n      // if it has a length property iterate over the items\n      // and return true if any match.\n      for (let i = 0, item; item = test[i]; i++) {\n        if (element == item || matchesSelector(element, item)) return true;\n      }\n    }\n  }\n  // Still here? Return false\n  return false;\n}\n\n\n/**\n * Tests whether a DOM element matches a selector. This polyfills the native\n * Element.prototype.matches method across browsers.\n * @param {!Element} element The DOM element to test.\n * @param {string} selector The CSS selector to test element against.\n * @return {boolean} True if the selector matches.\n */\nfunction matchesSelector(element, selector) {\n  if (typeof selector != 'string') return false;\n  if (nativeMatches) return nativeMatches.call(element, selector);\n  const nodes = element.parentNode.querySelectorAll(selector);\n  for (let i = 0, node; node = nodes[i]; i++) {\n    if (node == element) return true;\n  }\n  return false;\n}\n","import closest from './lib/closest';\nimport delegate from './lib/delegate';\nimport dispatch from './lib/dispatch';\nimport getAttributes from './lib/get-attributes';\nimport matches from './lib/matches';\nimport parents from './lib/parents';\nimport parseUrl from './lib/parse-url';\n\nexport {\n  closest,\n  delegate,\n  dispatch,\n  getAttributes,\n  matches,\n  parents,\n  parseUrl,\n};\n","/**\n * Returns an array of a DOM element's parent elements.\n * @param {!Element} element The DOM element whose parents to get.\n * @return {!Array} An array of all parent elemets, or an empty array if no\n *     parent elements are found.\n */\nexport default function parents(element) {\n  const list = [];\n  while (element && element.parentNode && element.parentNode.nodeType == 1) {\n    element = /** @type {!Element} */ (element.parentNode);\n    list.push(element);\n  }\n  return list;\n}\n","import matches from './matches';\nimport parents from './parents';\n\n/**\n * Gets the closest parent element that matches the passed selector.\n * @param {Element} element The element whose parents to check.\n * @param {string} selector The CSS selector to match against.\n * @param {boolean=} shouldCheckSelf True if the selector should test against\n *     the passed element itself.\n * @return {Element|undefined} The matching element or undefined.\n */\nexport default function closest(element, selector, shouldCheckSelf = false) {\n  if (!(element && element.nodeType == 1 && selector)) return;\n  const parentElements =\n      (shouldCheckSelf ? [element] : []).concat(parents(element));\n\n  for (let i = 0, parent; parent = parentElements[i]; i++) {\n    if (matches(parent, selector)) return parent;\n  }\n}\n","\n/**\n * Returns a wrapped version of the provided function.\n * If it's not called when the timeout is reached, it will be called regardless.\n * The wrapped function will also be prevented from being called more than once.\n *\n * @param {Function} callback\n * @param {number} wait\n * @return {Function}\n */\nexport function withTimeout(callback, wait = 2000) {\n  let wasCalled = false;\n  const fn = (...args) => {\n    if (!wasCalled) {\n      wasCalled = true;\n      callback(...args);\n    }\n  };\n  setTimeout(fn, wait);\n  return fn;\n}\n\n/**\n * Builds a simply query string from object.\n *\n * @param {object} obj\n * @return {string}\n */\nexport function buildQuery(obj) {\n  return Object.keys(obj).filter(k => obj[k]).map(k => `${encodeURIComponent(k)}=${encodeURIComponent(obj[k])}`).join('&');\n}\n\n/**\n * Will invoke the provided function when the DOM is ready.\n * If already ready, the callback will be invoked immediately.\n *\n * @param {Function} callback The ready callback.\n */\nexport function domReady(callback) {\n  if (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', function fn() {\n      document.removeEventListener('DOMContentLoaded', fn);\n      callback();\n    });\n  } else {\n    callback();\n  }\n}\n\n/**\n * Extracts an event fields object from a node.\n *\n * @param {DOMNode} node\n * @param {string} attrName\n * @return {object}\n */\nexport function extractFieldsFrom(node) {\n  if (node.nodeType !== 1) return {};\n  const data = node.getAttribute('data-fortnight-fields');\n  if (!data) return {};\n  try {\n    return JSON.parse(decodeURIComponent(data)) || {};\n  } catch (e) {\n    return {};\n  }\n}\n\n/**\n * Determines if a node is trackable for the provided action.\n *\n * @param {DOMNode} node\n * @param {string} action\n * @return {boolean}\n */\nexport function isTrackable(node, action) {\n  if (node.nodeType !== 1) return false;\n  const value = node.getAttribute('data-fortnight-action');\n  return action === value;\n}\n\nexport function logSupport(test, message) {\n  if (window.Raven && test) {\n    window.Raven.captureMessage(message, { level: 'warning' });\n  }\n}\n","import { delegate, parseUrl } from 'dom-utils';\nimport {\n  withTimeout,\n  extractFieldsFrom,\n  isTrackable,\n  logSupport,\n} from '../utils';\n\n/**\n * Determines if a link click event will cause the current page to unload.\n * @todo Need to determine if link is opened via the context menu.\n *\n * @param {Event} event\n * @param {Element} link\n * @return {boolean}\n */\nfunction linkWillUnloadPage(event, link) {\n  return !(\n    // Only look a click events that will not open a new window or tab\n    event.type !== 'click' || link.target === '_blank' ||\n    // Cmd+Click (Mac) and Ctrl+Click (Windows) opens a new tab\n    // Shift+Click opens a new window in Chrome/Firefox, in Safari it adds to favorites\n    // Opt+Click (Mac) is used to download\n    event.metaKey || event.ctrlKey || event.shiftKey || event.altKey ||\n    // Middle mouse clicks (2) open link in new tab\n    // Right clicks (3) on Firefox trigger a click event\n    event.which > 1\n  );\n}\n\nexport default class LinkListener {\n  /**\n   *\n   * @param {Tracker} tracker\n   * @param {object} options\n   */\n  constructor(tracker, options = {}) {\n    // Prevent execution when disabled or unsupported\n    logSupport(!options.enabled, 'LinkListener is disabled.');\n    logSupport(!window.addEventListener, 'addEventListener is not supported.');\n    if (!options.enabled || !window.addEventListener) return;\n\n    this.tracker = tracker;\n    const defaults = {\n      events: ['click'],\n      selector: 'a',\n      shouldTrackLink: LinkListener.shouldTrackLink,\n      callback: undefined,\n    };\n    this.opts = Object.assign(defaults, options);\n\n    this.handleInteractions = this.handleInteractions.bind(this);\n\n    this.delegates = {};\n    for (let i = 0; i < this.opts.events.length; i += 1) {\n      const event = this.opts.events[i];\n      this.delegates[event] = delegate(\n        document,\n        event,\n        this.opts.selector,\n        this.handleInteractions,\n        { composed: true, useCapture: true },\n      );\n    }\n  }\n\n  handleInteractions(event, link) {\n    if (this.opts.shouldTrackLink(link, parseUrl)) {\n      const href = link.getAttribute('href');\n      const fields = extractFieldsFrom(link);\n\n      const eventOpts = {\n        transport: 'beacon',\n        callback: this.opts.callback,\n      };\n\n      const supportsBeacon = navigator.sendBeacon || false;\n      if (!supportsBeacon && linkWillUnloadPage(event, link)) {\n        // The page will unload. Pause the transition and send the event.\n        const handler = () => {\n          window.removeEventListener('click', handler);\n\n          if (!event.defaultPrevented) {\n            event.preventDefault();\n\n            // @todo What happens when the user-land code already does something similar?\n            // For example, an event listener is previously attached to the link, that also\n            // triggers a window.location call. Wouldn't that prevent the event from\n            // being tracked?\n            const original = eventOpts.callback;\n            eventOpts.callback = withTimeout((...args) => {\n              if (typeof original === 'function') original(...args);\n              window.location.href = href;\n            });\n          }\n          this.tracker.execute('event', 'click', fields, eventOpts);\n        };\n        window.addEventListener('click', handler);\n      } else {\n        // Send the event directly.\n        this.tracker.execute('event', 'click', fields, eventOpts);\n      }\n    }\n  }\n\n  /**\n   * Determines if the link should be tracked.\n   *\n   * @param {Element} element\n   * @param {Function} urlParser\n   * @return {boolean}\n   */\n  static shouldTrackLink(element, urlParser) {\n    const href = element.getAttribute('href');\n    const url = urlParser(href);\n    return url.protocol.slice(0, 4) === 'http' && isTrackable(element, 'click');\n  }\n\n  /**\n   * Destroys all event listeners.\n   */\n  destroy() {\n    const keys = Object.keys(this.delegates);\n    for (let i = 0; i < keys.length; i += 1) {\n      const key = keys[i];\n      this.delegates[key].destroy();\n    }\n  }\n}\n","import { buildQuery } from '../utils';\n\nconst domain = 'https://fortnight.as3.io';\n\nexport default class EventTransport {\n  /**\n   * Constructor.\n   *\n   * @param {?object} options\n   * @param {?string} options.domain The backend domain.\n   */\n  constructor(options = {}) {\n    const defaults = { domain };\n    this.options = Object.assign(defaults, options);\n  }\n\n  /**\n   * Sends an event to the backend.\n   *\n   * @param {string} action The event action, e.g. `view`, `load` or `click`\n   * @param {object} fields The event fields\n   * @param {string} fields.pid The placement ID\n   * @param {string} fields.cid The campaign ID\n   * @param {?object} options The event options\n   * @param {?string} options.transport The transport type. Image is the default.\n   * @param {?Function} options.callback The callback to fire once complete.\n   */\n  send(\n    action,\n    { pid, cid, uuid } = {},\n    { transport, callback } = {},\n  ) {\n    const act = String(action).trim().toLowerCase();\n    if (!act) return;\n    const _ = (new Date()).getTime();\n    const params = {\n      pid,\n      cid,\n      uuid,\n      _,\n    };\n    const query = buildQuery(params);\n    const endpoint = `/e/${act}.gif?${query}`;\n    const url = this.createUrl(endpoint);\n\n    if (transport === 'beacon' && navigator.sendBeacon) {\n      if (typeof callback === 'function') callback(act, params);\n      navigator.sendBeacon(url);\n    } else {\n      const img = document.createElement('img');\n      if (typeof callback === 'function') {\n        img.onload = () => callback(act, params);\n        img.onerror = () => callback(act, params);\n      }\n      img.src = url;\n    }\n  }\n\n  /**\n   * Configures the domain name for sending events.\n   *\n   * @return string\n   */\n  get domain() {\n    if (!this.options.domain) return domain;\n    return `${this.options.domain.replace(/\\/+$/, '')}`;\n  }\n\n  /**\n   * Creates a URL using the provided endoint with the configured domain.\n   *\n   * @param {string} endpoint\n   * @return {string}\n   */\n  createUrl(endpoint) {\n    return `${this.domain}/${endpoint.replace(/^\\/+/, '')}`;\n  }\n}\n","import {\n  domReady,\n  extractFieldsFrom,\n  isTrackable,\n  logSupport,\n} from '../utils';\n\nrequire('intersection-observer');\n\n/**\n * Detects whether or not an intersection record is visible based on the threshold.\n *\n * @param {number} threshold\n * @param {IntersectionObserverEntry} record\n * @return {boolean}\n */\nfunction isVisible(threshold, record) {\n  if (threshold === 0) {\n    const i = record.intersectionRect;\n    return i.top > 0 || i.bottom > 0 || i.left > 0 || i.right > 0;\n  }\n  return record.intersectionRatio >= threshold;\n}\n\n/**\n * @todo We may want to explore including a MutationObserver polyfill.\n */\nexport default class ViewListener {\n  constructor(tracker, options = {}) {\n    // Disable if the browser does not support the required features.\n    logSupport(!window.IntersectionObserver, 'IntersectionObserver is not supported.');\n    logSupport(!window.MutationObserver, 'MutationObserver is not supported.');\n    if (!(window.IntersectionObserver && window.MutationObserver)) return;\n\n    const defaults = {\n      trackOnce: true,\n      threshold: 0.25,\n      rootMargin: '0px',\n    };\n    this.opts = Object.assign(defaults, options);\n\n    // Bind methods.\n    this.handleIntersection = this.handleIntersection.bind(this);\n    this.handleMutations = this.handleMutations.bind(this);\n    this.handleAddedElement = this.handleAddedElement.bind(this);\n    this.handleRemovedElement = this.handleRemovedElement.bind(this);\n\n    this.mutationObserver = null;\n    this.intersectionObserver = null;\n\n    this.tracker = tracker;\n\n    domReady(() => {\n      this.observeElements();\n    });\n  }\n\n  static getElements() {\n    return document.querySelectorAll('[data-fortnight-action=\"view\"]');\n  }\n\n  observeElements() {\n    // Setup intersection observer.\n    if (!this.intersectionObserver) {\n      this.intersectionObserver = new IntersectionObserver(this.handleIntersection, {\n        rootMargin: this.opts.rootMargin,\n        threshold: this.opts.threshold,\n      });\n      const elements = ViewListener.getElements();\n      for (let i = 0; i < elements.length; i += 1) {\n        const element = elements[i];\n        this.intersectionObserver.observe(element);\n      }\n    }\n\n    // Setup mutation observer.\n    if (!this.mutationObserver) {\n      this.mutationObserver = new MutationObserver(this.handleMutations);\n      this.mutationObserver.observe(document.body, {\n        childList: true,\n        subtree: true,\n      });\n    }\n\n    // https://bugs.chromium.org/p/chromium/issues/detail?id=612323\n    requestAnimationFrame(() => {});\n  }\n\n  unobserveAllElements() {\n    this.intersectionObserver.disconnect();\n    this.intersectionObserver = null;\n\n    this.mutationObserver.disconnect();\n    this.mutationObserver = null;\n\n    this.elementMap = {};\n  }\n\n  handleIntersection(records) {\n    for (let i = 0; i < records.length; i += 1) {\n      const record = records[i];\n      if (isVisible(this.opts.threshold, record)) {\n        const node = record.target;\n        this.sendEvent(node);\n        if (this.opts.trackOnce) {\n          this.handleRemovedElement(node);\n        }\n      }\n    }\n  }\n\n  handleMutations(mutations) {\n    for (let i = 0; i < mutations.length; i += 1) {\n      const mutation = mutations[i];\n      const { addedNodes, removedNodes } = mutation;\n      for (let r = 0; r < removedNodes.length; r += 1) {\n        const removed = removedNodes[r];\n        this.walkTree(removed, this.handleRemovedElement);\n      }\n      for (let a = 0; a < addedNodes.length; a += 1) {\n        const added = addedNodes[a];\n        this.walkTree(added, this.handleAddedElement);\n      }\n    }\n  }\n\n  handleAddedElement(node) {\n    if (node) {\n      this.intersectionObserver.observe(node);\n    }\n  }\n\n  handleRemovedElement(node) {\n    if (node) {\n      this.intersectionObserver.unobserve(node);\n    }\n  }\n\n  walkTree(node, callback) {\n    if (isTrackable(node, 'view')) {\n      callback(node);\n    }\n    for (let i = 0; i < node.childNodes.length; i += 1) {\n      const child = node.childNodes[i];\n      this.walkTree(child, callback);\n    }\n  }\n\n  sendEvent(node) {\n    const fields = extractFieldsFrom(node);\n    this.tracker.execute('event', 'view', fields, { transport: 'beacon' });\n  }\n\n  destroy() {\n    this.unobserveAllElements();\n  }\n}\n","import LinkListener from './link-listener';\nimport EventTransport from './event-transport';\nimport ViewListener from './view-listener';\n\nconst listeners = [];\n\nexport default class Tracker {\n  /**\n   * Constructor.\n   *\n   * @param {?object} options\n   * @param {boolean} [options.trackLinks=true] Whether to track links.\n   */\n  constructor(options = {}) {\n    const defaults = {\n      trackLinks: true,\n      debug: false,\n      onLinkTrack: undefined,\n    };\n    const opts = Object.assign(defaults, options);\n    this.opts = opts;\n\n    const transport = new EventTransport({ domain: opts.domain });\n    this.commands = {\n      event: transport.send.bind(transport),\n    };\n    listeners.push(new LinkListener(this, {\n      enabled: opts.trackLinks,\n      callback: opts.onLinkTrack,\n    }));\n    listeners.push(new ViewListener(this, {}));\n  }\n\n  /**\n   * Executes a command on the tracker.\n   *\n   * @param {string} command\n   * @param {...object} args\n   */\n  execute(command, ...args) {\n    if (this.commands[command]) {\n      if (this.opts.debug) {\n        // eslint-disable-next-line no-console\n        console.info('FORTNIGHT', 'Tracker.execute', command, ...args);\n      }\n      this.commands[command](...args);\n    }\n  }\n\n  /**\n   * The tracker instance is being destroyed.\n   * Destroy all event listeners.\n   */\n  destroy() { // eslint-disable-line class-methods-use-this\n    for (let i = 0; i < listeners.length; i += 1) {\n      const listener = listeners[i];\n      listener.destroy();\n    }\n  }\n}\n","import Tracker from './tracker';\n\nlet tracker;\nexport default function app(command, ...args) {\n  if (command === 'init') {\n    if (!tracker) tracker = new Tracker(...args);\n  } else if (command === 'destroy') {\n    if (tracker) {\n      tracker.destroy();\n      tracker = undefined;\n    }\n  } else {\n    if (!tracker) throw new Error('No Fortnight instance has been initialized.');\n    tracker.execute(command, ...args);\n  }\n}\n","import app from './app';\n\n// Find the command queue in the `window` object.\nconst WINDOW_VAR_NAME = 'FortnightObject';\nconst queueName = window[WINDOW_VAR_NAME];\nif (!queueName || !window[queueName]) {\n  throw new Error(`No ${WINDOW_VAR_NAME} object was found or initialized. Was the proper JavaScript included on the page?`);\n}\nconst commandQueue = window[queueName];\n\nconst execute = (stack) => {\n  for (let i = 0; i < stack.length; i += 1) {\n    const args = stack[i];\n    app(...args);\n  }\n};\n\n// Apply the queue to the app.\nconst queue = commandQueue.q;\nif (Array.isArray(queue)) {\n  // Find and send the init command first, in case the user sent the commands out of order.\n  const first = [];\n  const next = [];\n  for (let i = 0; i < queue.length; i += 1) {\n    const args = queue[i];\n    if (args[0] === 'init') {\n      first.push(args);\n    } else {\n      next.push(args);\n    }\n  }\n  execute(first);\n  execute(next);\n}\n\n// Replace the queue with the app.\nwindow[queueName] = app;\n","/**\n * Copyright 2016 Google Inc. All Rights Reserved.\n *\n * Licensed under the W3C SOFTWARE AND DOCUMENT NOTICE AND LICENSE.\n *\n *  https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document\n *\n */\n\n(function(window, document) {\n'use strict';\n\n\n// Exits early if all IntersectionObserver and IntersectionObserverEntry\n// features are natively supported.\nif ('IntersectionObserver' in window &&\n    'IntersectionObserverEntry' in window &&\n    'intersectionRatio' in window.IntersectionObserverEntry.prototype) {\n\n  // Minimal polyfill for Edge 15's lack of `isIntersecting`\n  // See: https://github.com/w3c/IntersectionObserver/issues/211\n  if (!('isIntersecting' in window.IntersectionObserverEntry.prototype)) {\n    Object.defineProperty(window.IntersectionObserverEntry.prototype,\n      'isIntersecting', {\n      get: function () {\n        return this.intersectionRatio > 0;\n      }\n    });\n  }\n  return;\n}\n\n\n/**\n * An IntersectionObserver registry. This registry exists to hold a strong\n * reference to IntersectionObserver instances currently observering a target\n * element. Without this registry, instances without another reference may be\n * garbage collected.\n */\nvar registry = [];\n\n\n/**\n * Creates the global IntersectionObserverEntry constructor.\n * https://w3c.github.io/IntersectionObserver/#intersection-observer-entry\n * @param {Object} entry A dictionary of instance properties.\n * @constructor\n */\nfunction IntersectionObserverEntry(entry) {\n  this.time = entry.time;\n  this.target = entry.target;\n  this.rootBounds = entry.rootBounds;\n  this.boundingClientRect = entry.boundingClientRect;\n  this.intersectionRect = entry.intersectionRect || getEmptyRect();\n  this.isIntersecting = !!entry.intersectionRect;\n\n  // Calculates the intersection ratio.\n  var targetRect = this.boundingClientRect;\n  var targetArea = targetRect.width * targetRect.height;\n  var intersectionRect = this.intersectionRect;\n  var intersectionArea = intersectionRect.width * intersectionRect.height;\n\n  // Sets intersection ratio.\n  if (targetArea) {\n    this.intersectionRatio = intersectionArea / targetArea;\n  } else {\n    // If area is zero and is intersecting, sets to 1, otherwise to 0\n    this.intersectionRatio = this.isIntersecting ? 1 : 0;\n  }\n}\n\n\n/**\n * Creates the global IntersectionObserver constructor.\n * https://w3c.github.io/IntersectionObserver/#intersection-observer-interface\n * @param {Function} callback The function to be invoked after intersection\n *     changes have queued. The function is not invoked if the queue has\n *     been emptied by calling the `takeRecords` method.\n * @param {Object=} opt_options Optional configuration options.\n * @constructor\n */\nfunction IntersectionObserver(callback, opt_options) {\n\n  var options = opt_options || {};\n\n  if (typeof callback != 'function') {\n    throw new Error('callback must be a function');\n  }\n\n  if (options.root && options.root.nodeType != 1) {\n    throw new Error('root must be an Element');\n  }\n\n  // Binds and throttles `this._checkForIntersections`.\n  this._checkForIntersections = throttle(\n      this._checkForIntersections.bind(this), this.THROTTLE_TIMEOUT);\n\n  // Private properties.\n  this._callback = callback;\n  this._observationTargets = [];\n  this._queuedEntries = [];\n  this._rootMarginValues = this._parseRootMargin(options.rootMargin);\n\n  // Public properties.\n  this.thresholds = this._initThresholds(options.threshold);\n  this.root = options.root || null;\n  this.rootMargin = this._rootMarginValues.map(function(margin) {\n    return margin.value + margin.unit;\n  }).join(' ');\n}\n\n\n/**\n * The minimum interval within which the document will be checked for\n * intersection changes.\n */\nIntersectionObserver.prototype.THROTTLE_TIMEOUT = 100;\n\n\n/**\n * The frequency in which the polyfill polls for intersection changes.\n * this can be updated on a per instance basis and must be set prior to\n * calling `observe` on the first target.\n */\nIntersectionObserver.prototype.POLL_INTERVAL = null;\n\n/**\n * Use a mutation observer on the root element\n * to detect intersection changes.\n */\nIntersectionObserver.prototype.USE_MUTATION_OBSERVER = true;\n\n\n/**\n * Starts observing a target element for intersection changes based on\n * the thresholds values.\n * @param {Element} target The DOM element to observe.\n */\nIntersectionObserver.prototype.observe = function(target) {\n  var isTargetAlreadyObserved = this._observationTargets.some(function(item) {\n    return item.element == target;\n  });\n\n  if (isTargetAlreadyObserved) {\n    return;\n  }\n\n  if (!(target && target.nodeType == 1)) {\n    throw new Error('target must be an Element');\n  }\n\n  this._registerInstance();\n  this._observationTargets.push({element: target, entry: null});\n  this._monitorIntersections();\n  this._checkForIntersections();\n};\n\n\n/**\n * Stops observing a target element for intersection changes.\n * @param {Element} target The DOM element to observe.\n */\nIntersectionObserver.prototype.unobserve = function(target) {\n  this._observationTargets =\n      this._observationTargets.filter(function(item) {\n\n    return item.element != target;\n  });\n  if (!this._observationTargets.length) {\n    this._unmonitorIntersections();\n    this._unregisterInstance();\n  }\n};\n\n\n/**\n * Stops observing all target elements for intersection changes.\n */\nIntersectionObserver.prototype.disconnect = function() {\n  this._observationTargets = [];\n  this._unmonitorIntersections();\n  this._unregisterInstance();\n};\n\n\n/**\n * Returns any queue entries that have not yet been reported to the\n * callback and clears the queue. This can be used in conjunction with the\n * callback to obtain the absolute most up-to-date intersection information.\n * @return {Array} The currently queued entries.\n */\nIntersectionObserver.prototype.takeRecords = function() {\n  var records = this._queuedEntries.slice();\n  this._queuedEntries = [];\n  return records;\n};\n\n\n/**\n * Accepts the threshold value from the user configuration object and\n * returns a sorted array of unique threshold values. If a value is not\n * between 0 and 1 and error is thrown.\n * @private\n * @param {Array|number=} opt_threshold An optional threshold value or\n *     a list of threshold values, defaulting to [0].\n * @return {Array} A sorted list of unique and valid threshold values.\n */\nIntersectionObserver.prototype._initThresholds = function(opt_threshold) {\n  var threshold = opt_threshold || [0];\n  if (!Array.isArray(threshold)) threshold = [threshold];\n\n  return threshold.sort().filter(function(t, i, a) {\n    if (typeof t != 'number' || isNaN(t) || t < 0 || t > 1) {\n      throw new Error('threshold must be a number between 0 and 1 inclusively');\n    }\n    return t !== a[i - 1];\n  });\n};\n\n\n/**\n * Accepts the rootMargin value from the user configuration object\n * and returns an array of the four margin values as an object containing\n * the value and unit properties. If any of the values are not properly\n * formatted or use a unit other than px or %, and error is thrown.\n * @private\n * @param {string=} opt_rootMargin An optional rootMargin value,\n *     defaulting to '0px'.\n * @return {Array<Object>} An array of margin objects with the keys\n *     value and unit.\n */\nIntersectionObserver.prototype._parseRootMargin = function(opt_rootMargin) {\n  var marginString = opt_rootMargin || '0px';\n  var margins = marginString.split(/\\s+/).map(function(margin) {\n    var parts = /^(-?\\d*\\.?\\d+)(px|%)$/.exec(margin);\n    if (!parts) {\n      throw new Error('rootMargin must be specified in pixels or percent');\n    }\n    return {value: parseFloat(parts[1]), unit: parts[2]};\n  });\n\n  // Handles shorthand.\n  margins[1] = margins[1] || margins[0];\n  margins[2] = margins[2] || margins[0];\n  margins[3] = margins[3] || margins[1];\n\n  return margins;\n};\n\n\n/**\n * Starts polling for intersection changes if the polling is not already\n * happening, and if the page's visibilty state is visible.\n * @private\n */\nIntersectionObserver.prototype._monitorIntersections = function() {\n  if (!this._monitoringIntersections) {\n    this._monitoringIntersections = true;\n\n    // If a poll interval is set, use polling instead of listening to\n    // resize and scroll events or DOM mutations.\n    if (this.POLL_INTERVAL) {\n      this._monitoringInterval = setInterval(\n          this._checkForIntersections, this.POLL_INTERVAL);\n    }\n    else {\n      addEvent(window, 'resize', this._checkForIntersections, true);\n      addEvent(document, 'scroll', this._checkForIntersections, true);\n\n      if (this.USE_MUTATION_OBSERVER && 'MutationObserver' in window) {\n        this._domObserver = new MutationObserver(this._checkForIntersections);\n        this._domObserver.observe(document, {\n          attributes: true,\n          childList: true,\n          characterData: true,\n          subtree: true\n        });\n      }\n    }\n  }\n};\n\n\n/**\n * Stops polling for intersection changes.\n * @private\n */\nIntersectionObserver.prototype._unmonitorIntersections = function() {\n  if (this._monitoringIntersections) {\n    this._monitoringIntersections = false;\n\n    clearInterval(this._monitoringInterval);\n    this._monitoringInterval = null;\n\n    removeEvent(window, 'resize', this._checkForIntersections, true);\n    removeEvent(document, 'scroll', this._checkForIntersections, true);\n\n    if (this._domObserver) {\n      this._domObserver.disconnect();\n      this._domObserver = null;\n    }\n  }\n};\n\n\n/**\n * Scans each observation target for intersection changes and adds them\n * to the internal entries queue. If new entries are found, it\n * schedules the callback to be invoked.\n * @private\n */\nIntersectionObserver.prototype._checkForIntersections = function() {\n  var rootIsInDom = this._rootIsInDom();\n  var rootRect = rootIsInDom ? this._getRootRect() : getEmptyRect();\n\n  this._observationTargets.forEach(function(item) {\n    var target = item.element;\n    var targetRect = getBoundingClientRect(target);\n    var rootContainsTarget = this._rootContainsTarget(target);\n    var oldEntry = item.entry;\n    var intersectionRect = rootIsInDom && rootContainsTarget &&\n        this._computeTargetAndRootIntersection(target, rootRect);\n\n    var newEntry = item.entry = new IntersectionObserverEntry({\n      time: now(),\n      target: target,\n      boundingClientRect: targetRect,\n      rootBounds: rootRect,\n      intersectionRect: intersectionRect\n    });\n\n    if (!oldEntry) {\n      this._queuedEntries.push(newEntry);\n    } else if (rootIsInDom && rootContainsTarget) {\n      // If the new entry intersection ratio has crossed any of the\n      // thresholds, add a new entry.\n      if (this._hasCrossedThreshold(oldEntry, newEntry)) {\n        this._queuedEntries.push(newEntry);\n      }\n    } else {\n      // If the root is not in the DOM or target is not contained within\n      // root but the previous entry for this target had an intersection,\n      // add a new record indicating removal.\n      if (oldEntry && oldEntry.isIntersecting) {\n        this._queuedEntries.push(newEntry);\n      }\n    }\n  }, this);\n\n  if (this._queuedEntries.length) {\n    this._callback(this.takeRecords(), this);\n  }\n};\n\n\n/**\n * Accepts a target and root rect computes the intersection between then\n * following the algorithm in the spec.\n * TODO(philipwalton): at this time clip-path is not considered.\n * https://w3c.github.io/IntersectionObserver/#calculate-intersection-rect-algo\n * @param {Element} target The target DOM element\n * @param {Object} rootRect The bounding rect of the root after being\n *     expanded by the rootMargin value.\n * @return {?Object} The final intersection rect object or undefined if no\n *     intersection is found.\n * @private\n */\nIntersectionObserver.prototype._computeTargetAndRootIntersection =\n    function(target, rootRect) {\n\n  // If the element isn't displayed, an intersection can't happen.\n  if (window.getComputedStyle(target).display == 'none') return;\n\n  var targetRect = getBoundingClientRect(target);\n  var intersectionRect = targetRect;\n  var parent = getParentNode(target);\n  var atRoot = false;\n\n  while (!atRoot) {\n    var parentRect = null;\n    var parentComputedStyle = parent.nodeType == 1 ?\n        window.getComputedStyle(parent) : {};\n\n    // If the parent isn't displayed, an intersection can't happen.\n    if (parentComputedStyle.display == 'none') return;\n\n    if (parent == this.root || parent == document) {\n      atRoot = true;\n      parentRect = rootRect;\n    } else {\n      // If the element has a non-visible overflow, and it's not the <body>\n      // or <html> element, update the intersection rect.\n      // Note: <body> and <html> cannot be clipped to a rect that's not also\n      // the document rect, so no need to compute a new intersection.\n      if (parent != document.body &&\n          parent != document.documentElement &&\n          parentComputedStyle.overflow != 'visible') {\n        parentRect = getBoundingClientRect(parent);\n      }\n    }\n\n    // If either of the above conditionals set a new parentRect,\n    // calculate new intersection data.\n    if (parentRect) {\n      intersectionRect = computeRectIntersection(parentRect, intersectionRect);\n\n      if (!intersectionRect) break;\n    }\n    parent = getParentNode(parent);\n  }\n  return intersectionRect;\n};\n\n\n/**\n * Returns the root rect after being expanded by the rootMargin value.\n * @return {Object} The expanded root rect.\n * @private\n */\nIntersectionObserver.prototype._getRootRect = function() {\n  var rootRect;\n  if (this.root) {\n    rootRect = getBoundingClientRect(this.root);\n  } else {\n    // Use <html>/<body> instead of window since scroll bars affect size.\n    var html = document.documentElement;\n    var body = document.body;\n    rootRect = {\n      top: 0,\n      left: 0,\n      right: html.clientWidth || body.clientWidth,\n      width: html.clientWidth || body.clientWidth,\n      bottom: html.clientHeight || body.clientHeight,\n      height: html.clientHeight || body.clientHeight\n    };\n  }\n  return this._expandRectByRootMargin(rootRect);\n};\n\n\n/**\n * Accepts a rect and expands it by the rootMargin value.\n * @param {Object} rect The rect object to expand.\n * @return {Object} The expanded rect.\n * @private\n */\nIntersectionObserver.prototype._expandRectByRootMargin = function(rect) {\n  var margins = this._rootMarginValues.map(function(margin, i) {\n    return margin.unit == 'px' ? margin.value :\n        margin.value * (i % 2 ? rect.width : rect.height) / 100;\n  });\n  var newRect = {\n    top: rect.top - margins[0],\n    right: rect.right + margins[1],\n    bottom: rect.bottom + margins[2],\n    left: rect.left - margins[3]\n  };\n  newRect.width = newRect.right - newRect.left;\n  newRect.height = newRect.bottom - newRect.top;\n\n  return newRect;\n};\n\n\n/**\n * Accepts an old and new entry and returns true if at least one of the\n * threshold values has been crossed.\n * @param {?IntersectionObserverEntry} oldEntry The previous entry for a\n *    particular target element or null if no previous entry exists.\n * @param {IntersectionObserverEntry} newEntry The current entry for a\n *    particular target element.\n * @return {boolean} Returns true if a any threshold has been crossed.\n * @private\n */\nIntersectionObserver.prototype._hasCrossedThreshold =\n    function(oldEntry, newEntry) {\n\n  // To make comparing easier, an entry that has a ratio of 0\n  // but does not actually intersect is given a value of -1\n  var oldRatio = oldEntry && oldEntry.isIntersecting ?\n      oldEntry.intersectionRatio || 0 : -1;\n  var newRatio = newEntry.isIntersecting ?\n      newEntry.intersectionRatio || 0 : -1;\n\n  // Ignore unchanged ratios\n  if (oldRatio === newRatio) return;\n\n  for (var i = 0; i < this.thresholds.length; i++) {\n    var threshold = this.thresholds[i];\n\n    // Return true if an entry matches a threshold or if the new ratio\n    // and the old ratio are on the opposite sides of a threshold.\n    if (threshold == oldRatio || threshold == newRatio ||\n        threshold < oldRatio !== threshold < newRatio) {\n      return true;\n    }\n  }\n};\n\n\n/**\n * Returns whether or not the root element is an element and is in the DOM.\n * @return {boolean} True if the root element is an element and is in the DOM.\n * @private\n */\nIntersectionObserver.prototype._rootIsInDom = function() {\n  return !this.root || containsDeep(document, this.root);\n};\n\n\n/**\n * Returns whether or not the target element is a child of root.\n * @param {Element} target The target element to check.\n * @return {boolean} True if the target element is a child of root.\n * @private\n */\nIntersectionObserver.prototype._rootContainsTarget = function(target) {\n  return containsDeep(this.root || document, target);\n};\n\n\n/**\n * Adds the instance to the global IntersectionObserver registry if it isn't\n * already present.\n * @private\n */\nIntersectionObserver.prototype._registerInstance = function() {\n  if (registry.indexOf(this) < 0) {\n    registry.push(this);\n  }\n};\n\n\n/**\n * Removes the instance from the global IntersectionObserver registry.\n * @private\n */\nIntersectionObserver.prototype._unregisterInstance = function() {\n  var index = registry.indexOf(this);\n  if (index != -1) registry.splice(index, 1);\n};\n\n\n/**\n * Returns the result of the performance.now() method or null in browsers\n * that don't support the API.\n * @return {number} The elapsed time since the page was requested.\n */\nfunction now() {\n  return window.performance && performance.now && performance.now();\n}\n\n\n/**\n * Throttles a function and delays its executiong, so it's only called at most\n * once within a given time period.\n * @param {Function} fn The function to throttle.\n * @param {number} timeout The amount of time that must pass before the\n *     function can be called again.\n * @return {Function} The throttled function.\n */\nfunction throttle(fn, timeout) {\n  var timer = null;\n  return function () {\n    if (!timer) {\n      timer = setTimeout(function() {\n        fn();\n        timer = null;\n      }, timeout);\n    }\n  };\n}\n\n\n/**\n * Adds an event handler to a DOM node ensuring cross-browser compatibility.\n * @param {Node} node The DOM node to add the event handler to.\n * @param {string} event The event name.\n * @param {Function} fn The event handler to add.\n * @param {boolean} opt_useCapture Optionally adds the even to the capture\n *     phase. Note: this only works in modern browsers.\n */\nfunction addEvent(node, event, fn, opt_useCapture) {\n  if (typeof node.addEventListener == 'function') {\n    node.addEventListener(event, fn, opt_useCapture || false);\n  }\n  else if (typeof node.attachEvent == 'function') {\n    node.attachEvent('on' + event, fn);\n  }\n}\n\n\n/**\n * Removes a previously added event handler from a DOM node.\n * @param {Node} node The DOM node to remove the event handler from.\n * @param {string} event The event name.\n * @param {Function} fn The event handler to remove.\n * @param {boolean} opt_useCapture If the event handler was added with this\n *     flag set to true, it should be set to true here in order to remove it.\n */\nfunction removeEvent(node, event, fn, opt_useCapture) {\n  if (typeof node.removeEventListener == 'function') {\n    node.removeEventListener(event, fn, opt_useCapture || false);\n  }\n  else if (typeof node.detatchEvent == 'function') {\n    node.detatchEvent('on' + event, fn);\n  }\n}\n\n\n/**\n * Returns the intersection between two rect objects.\n * @param {Object} rect1 The first rect.\n * @param {Object} rect2 The second rect.\n * @return {?Object} The intersection rect or undefined if no intersection\n *     is found.\n */\nfunction computeRectIntersection(rect1, rect2) {\n  var top = Math.max(rect1.top, rect2.top);\n  var bottom = Math.min(rect1.bottom, rect2.bottom);\n  var left = Math.max(rect1.left, rect2.left);\n  var right = Math.min(rect1.right, rect2.right);\n  var width = right - left;\n  var height = bottom - top;\n\n  return (width >= 0 && height >= 0) && {\n    top: top,\n    bottom: bottom,\n    left: left,\n    right: right,\n    width: width,\n    height: height\n  };\n}\n\n\n/**\n * Shims the native getBoundingClientRect for compatibility with older IE.\n * @param {Element} el The element whose bounding rect to get.\n * @return {Object} The (possibly shimmed) rect of the element.\n */\nfunction getBoundingClientRect(el) {\n  var rect;\n\n  try {\n    rect = el.getBoundingClientRect();\n  } catch (err) {\n    // Ignore Windows 7 IE11 \"Unspecified error\"\n    // https://github.com/w3c/IntersectionObserver/pull/205\n  }\n\n  if (!rect) return getEmptyRect();\n\n  // Older IE\n  if (!(rect.width && rect.height)) {\n    rect = {\n      top: rect.top,\n      right: rect.right,\n      bottom: rect.bottom,\n      left: rect.left,\n      width: rect.right - rect.left,\n      height: rect.bottom - rect.top\n    };\n  }\n  return rect;\n}\n\n\n/**\n * Returns an empty rect object. An empty rect is returned when an element\n * is not in the DOM.\n * @return {Object} The empty rect.\n */\nfunction getEmptyRect() {\n  return {\n    top: 0,\n    bottom: 0,\n    left: 0,\n    right: 0,\n    width: 0,\n    height: 0\n  };\n}\n\n/**\n * Checks to see if a parent element contains a child elemnt (including inside\n * shadow DOM).\n * @param {Node} parent The parent element.\n * @param {Node} child The child element.\n * @return {boolean} True if the parent node contains the child node.\n */\nfunction containsDeep(parent, child) {\n  var node = child;\n  while (node) {\n    if (node == parent) return true;\n\n    node = getParentNode(node);\n  }\n  return false;\n}\n\n\n/**\n * Gets the parent node of an element or its host element if the parent node\n * is a shadow root.\n * @param {Node} node The node whose parent to get.\n * @return {Node|null} The parent node or null if no parent exists.\n */\nfunction getParentNode(node) {\n  var parent = node.parentNode;\n\n  if (parent && parent.nodeType == 11 && parent.host) {\n    // If the parent is a shadow root, return the host element.\n    return parent.host;\n  }\n  return parent;\n}\n\n\n// Exposes the constructors globally.\nwindow.IntersectionObserver = IntersectionObserver;\nwindow.IntersectionObserverEntry = IntersectionObserverEntry;\n\n}(window, document));\n","const HTTP_PORT = '80';\nconst HTTPS_PORT = '443';\nconst DEFAULT_PORT = RegExp(':(' + HTTP_PORT + '|' + HTTPS_PORT + ')$');\n\n\nconst a = document.createElement('a');\nconst cache = {};\n\n\n/**\n * Parses the given url and returns an object mimicing a `Location` object.\n * @param {string} url The url to parse.\n * @return {!Object} An object with the same properties as a `Location`.\n */\nexport default function parseUrl(url) {\n  // All falsy values (as well as \".\") should map to the current URL.\n  url = (!url || url == '.') ? location.href : url;\n\n  if (cache[url]) return cache[url];\n\n  a.href = url;\n\n  // When parsing file relative paths (e.g. `../index.html`), IE will correctly\n  // resolve the `href` property but will keep the `..` in the `path` property.\n  // It will also not include the `host` or `hostname` properties. Furthermore,\n  // IE will sometimes return no protocol or just a colon, especially for things\n  // like relative protocol URLs (e.g. \"//google.com\").\n  // To workaround all of these issues, we reparse with the full URL from the\n  // `href` property.\n  if (url.charAt(0) == '.' || url.charAt(0) == '/') return parseUrl(a.href);\n\n  // Don't include default ports.\n  let port = (a.port == HTTP_PORT || a.port == HTTPS_PORT) ? '' : a.port;\n\n  // PhantomJS sets the port to \"0\" when using the file: protocol.\n  port = port == '0' ? '' : port;\n\n  // Sometimes IE incorrectly includes a port for default ports\n  // (e.g. `:80` or `:443`) even when no port is specified in the URL.\n  // http://bit.ly/1rQNoMg\n  const host = a.host.replace(DEFAULT_PORT, '');\n\n  // Not all browser support `origin` so we have to build it.\n  const origin = a.origin ? a.origin : a.protocol + '//' + host;\n\n  // Sometimes IE doesn't include the leading slash for pathname.\n  // http://bit.ly/1rQNoMg\n  const pathname = a.pathname.charAt(0) == '/' ? a.pathname : '/' + a.pathname;\n\n  return cache[url] = {\n    hash: a.hash,\n    host: host,\n    hostname: a.hostname,\n    href: a.href,\n    origin: origin,\n    pathname: pathname,\n    port: port,\n    protocol: a.protocol,\n    search: a.search,\n  };\n}\n","/**\n * Gets all attributes of an element as a plain JavaScriot object.\n * @param {Element} element The element whose attributes to get.\n * @return {!Object} An object whose keys are the attribute keys and whose\n *     values are the attribute values. If no attributes exist, an empty\n *     object is returned.\n */\nexport default function getAttributes(element) {\n  const attrs = {};\n\n  // Validate input.\n  if (!(element && element.nodeType == 1)) return attrs;\n\n  // Return an empty object if there are no attributes.\n  const map = element.attributes;\n  if (map.length === 0) return {};\n\n  for (let i = 0, attr; attr = map[i]; i++) {\n    attrs[attr.name] = attr.value;\n  }\n  return attrs;\n}\n","/**\n * Dispatches an event on the passed element.\n * @param {!Element} element The DOM element to dispatch the event on.\n * @param {string} eventType The type of event to dispatch.\n * @param {Object|string=} eventName A string name of the event constructor\n *     to use. Defaults to 'Event' if nothing is passed or 'CustomEvent' if\n *     a value is set on `initDict.detail`. If eventName is given an object\n *     it is assumed to be initDict and thus reassigned.\n * @param {Object=} initDict The initialization attributes for the\n *     event. A `detail` property can be used here to pass custom data.\n * @return {boolean} The return value of `element.dispatchEvent`, which will\n *     be false if any of the event listeners called `preventDefault`.\n */\nexport default function dispatch(\n    element, eventType, eventName = 'Event', initDict = {}) {\n  let event;\n  let isCustom;\n\n  // eventName is optional\n  if (typeof eventName == 'object') {\n    initDict = eventName;\n    eventName = 'Event';\n  }\n\n  initDict.bubbles = initDict.bubbles || false;\n  initDict.cancelable = initDict.cancelable || false;\n  initDict.composed = initDict.composed || false;\n\n  // If a detail property is passed, this is a custom event.\n  if ('detail' in initDict) isCustom = true;\n  eventName = isCustom ? 'CustomEvent' : eventName;\n\n  // Tries to create the event using constructors, if that doesn't work,\n  // fallback to `document.createEvent()`.\n  try {\n    event = new window[eventName](eventType, initDict);\n  } catch(err) {\n    event = document.createEvent(eventName);\n    const initMethod = 'init' + (isCustom ? 'Custom' : '') + 'Event';\n    event[initMethod](eventType, initDict.bubbles,\n                      initDict.cancelable, initDict.detail);\n  }\n\n  return element.dispatchEvent(event);\n}\n","import closest from './closest';\nimport matches from './matches';\n\n/**\n * Delegates the handling of events for an element matching a selector to an\n * ancestor of the matching element.\n * @param {!Node} ancestor The ancestor element to add the listener to.\n * @param {string} eventType The event type to listen to.\n * @param {string} selector A CSS selector to match against child elements.\n * @param {!Function} callback A function to run any time the event happens.\n * @param {Object=} opts A configuration options object. The available options:\n *     - useCapture<boolean>: If true, bind to the event capture phase.\n *     - deep<boolean>: If true, delegate into shadow trees.\n * @return {Object} The delegate object. It contains a destroy method.\n */\nexport default function delegate(\n    ancestor, eventType, selector, callback, opts = {}) {\n  // Defines the event listener.\n  const listener = function(event) {\n    let delegateTarget;\n\n    // If opts.composed is true and the event originated from inside a Shadow\n    // tree, check the composed path nodes.\n    if (opts.composed && typeof event.composedPath == 'function') {\n      const composedPath = event.composedPath();\n      for (let i = 0, node; node = composedPath[i]; i++) {\n        if (node.nodeType == 1 && matches(node, selector)) {\n          delegateTarget = node;\n        }\n      }\n    } else {\n      // Otherwise check the parents.\n      delegateTarget = closest(event.target, selector, true);\n    }\n\n    if (delegateTarget) {\n      callback.call(delegateTarget, event, delegateTarget);\n    }\n  };\n\n  ancestor.addEventListener(eventType, listener, opts.useCapture);\n\n  return {\n    destroy: function() {\n      ancestor.removeEventListener(eventType, listener, opts.useCapture);\n    },\n  };\n}\n"],"sourceRoot":""}